# 1 背景
公司和在家里一直都是在windows环境进行java和python开发，本地测试主要是通过UT和Postman，最终也会部署到PaaS环境中，为了在家里锻炼自己的服务部署能力和linux能力，想折腾出一套方案，windows进行系统开发，开发好的服务和容器都部署到ubuntu中，于是思索并实践了一下几种方案：
1. 本机开发，本地WSL部署服务。结果不完美，WSL中启动Docker进程总是被无缘无故杀死……据说还是要配合Docker for windows使用，但是，那家公司会这么玩呢？放弃。
2. 本地开发，本地跑VMware player（个人免费版）运行ubuntu server。一开始是十分完美的！！网络适配器是默认的NAT模式，也可以直接在窗口对ubuntu server进行操作，完全不需要ssh，也没有探究如何ssh到本机虚拟机中的ubuntu server。后来，妹子总是霸占我的开发机，用大屏幕看剧……我只能用自己的笔记本开发了，毕竟在共同一个局域网，想想ssh回开发机中的ubuntu server也方便，NAT模式下，虚拟机和宿主机共享一个局域网IP，并且内部网络结果对于我的笔记本是隐藏的，因此，只能通过端口转发，实现ssh到虚拟机的端口，经过查验，免费个人版的VMware不支持NAT端口转发设置，卒……但是我又坚决不用盗版软件……
3. 本地开发，同局域网台式机跑VirtualBox运行ubuntu server。最终，通过这种方式实现了，无论台式机还是笔记本开发，都能以sftp或者ssh的方式进行远程部署。
接一下，以方案3为例，记录一下折腾过程。
# 2 过程
1. 由于家里的所有设备基本都是联网的，同时，我还给路由定了定时重启的计划，而路由器默认是开启DHCP，即动态分配局域网IP，要是自己的服务器IP不固定（有msb之类的也是可以动态IP的，这里不谈），那怎么行？小米路由器自带的DHCP静态IP分配功能，固定住跑ubuntu server的台式机IP即可。
2. 台式机安装virtualBox，并安装相应的linux发行版，本人使用ubuntu server，在网络设置中，网络模式为NAT模式，同时按照下图设置端口转发规则：
![NAT转发规则设置](https://img-blog.csdnimg.cn/2019072223342074.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2plYXNvbl9jaGFuX3pqdQ==,size_16,color_FFFFFF,t_70)
（ssh的默认端口就是22。）
名称是xxxx localhost的，方便台式机本地ssh到虚拟机中的ubuntu；当台式机向127.0.0.1:22ssh时，会自动转发到子系统的22端口。
名称是xxxx  remote的， 主机IP是台式机的局域网IP；当局域网中的笔记本向台式机（IP:192.168.31.224）的22端口ssh时，自动转发到子系统的22端口。
使用举例：
```bash
# 默认端口是22，可不写"-p 22"
# 台式机ssh到虚拟机中的ubuntu
ssh -p 22 用户名@127.0.0.1
# 笔记本ssh到台式机的虚拟机中的ubuntu
ssh -p 22 用户名@192.168.31.224
```
3. 有时候在外面的时候想ssh到自己台式机中的ubuntu server看看，同样的，路由器中设置端口转发，比如，将外网对路由器22的请求，转换到我台式机的192.168.31.224：22，即可实现外网ssh，可以辣鸡长城宽带大内网，没有公网IP，可以通过花生壳自行解决，原理就是将发到花生壳网址某端口的请求，转发到你路由器中，再由路由器转发到局域网中的台式机，台式机再转发给自己内部的虚拟机。
由于本人ubuntu密码和用户都过于简单，就不进公网了……
4. 台式机开超低功耗模式，就可以24开始跑服务了，也不用关机，相当于租了云主机……23333
